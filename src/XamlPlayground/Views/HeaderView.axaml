<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:console="https://github.com/jinek/consolonia"
             xmlns:vm="clr-namespace:XamlPlayground.ViewModels"
             mc:Ignorable="d" d:DesignWidth="915" d:DesignHeight="500"
             x:Class="XamlPlayground.Views.HeaderView"
             Background="#8B44AC"
             x:CompileBindings="True" x:DataType="vm:MainViewModel">
  <UserControl.Resources>
    <StreamGeometry x:Key="SettingsIcon">M27.7656 15.3438Q27.7656 15.4844 27.7734 15.625Q27.7812 15.7656 27.7813 15.9063Q27.7813 16.0469 27.7734 16.1875Q27.7656 16.3281 27.7656 16.4688L31.8125 18.9844L29.3281 24.9688L24.6875 23.9063Q24.3125 24.3125 23.9063 24.6875L24.9688 29.3281L18.9844 31.8125L16.4688 27.7656Q16.3281 27.7656 16.1875 27.7734Q16.0469 27.7813 15.9063 27.7813Q15.7656 27.7813 15.625 27.7734Q15.4844 27.7656 15.3438 27.7656L12.8281 31.8125L6.84375 29.3281L7.90625 24.6875Q7.5 24.3125 7.125 23.9063L2.48438 24.9688L0 18.9844L4.04688 16.4688Q4.04688 16.3281 4.03906 16.1875Q4.03125 16.0469 4.03125 15.9063Q4.03125 15.7656 4.03906 15.625Q4.04687 15.4844 4.04688 15.3438L0 12.8281L2.48438 6.84375L7.125 7.90625Q7.5 7.5 7.90625 7.125L6.84375 2.48438L12.8281 0L15.3438 4.04688Q15.4844 4.04688 15.625 4.03906Q15.7656 4.03125 15.9063 4.03125Q16.0469 4.03125 16.1875 4.03906Q16.3281 4.04688 16.4688 4.04688L18.9844 0L24.9688 2.48438L23.9063 7.125Q24.3125 7.5 24.6875 7.90625L29.3281 6.84375L31.8125 12.8281L27.7656 15.3438ZM25.9375 17.375Q25.9687 17 26 16.6328Q26.0312 16.2656 26.0313 15.8906Q26.0313 15.5313 26 15.1563Q25.9687 14.7813 25.9375 14.4219L29.625 12.125L28.2813 8.875L24.0469 9.85938Q23.5625 9.26563 23.0547 8.76563Q22.5469 8.26563 21.9531 7.76563L22.9375 3.53125L19.6875 2.1875L17.375 5.875Q17.0156 5.84375 16.6406 5.8125Q16.2656 5.78125 15.9063 5.78125Q15.5313 5.78125 15.1641 5.8125Q14.7969 5.84375 14.4219 5.875L12.125 2.1875L8.875 3.53125L9.85938 7.76563Q9.26562 8.25 8.76563 8.75781Q8.26562 9.26563 7.76563 9.85938L3.53125 8.875L2.1875 12.125L5.875 14.4375Q5.84375 14.8125 5.8125 15.1797Q5.78125 15.5469 5.78125 15.9219Q5.78125 16.2813 5.8125 16.6563Q5.84375 17.0313 5.875 17.3906L2.1875 19.6875L3.53125 22.9375L7.76563 21.9531Q8.25 22.5469 8.75781 23.0469Q9.26562 23.5469 9.85938 24.0469L8.875 28.2813L12.125 29.625L14.4375 25.9375Q14.7969 25.9688 15.1719 26Q15.5469 26.0313 15.9063 26.0313Q16.2813 26.0313 16.6484 26Q17.0156 25.9688 17.3906 25.9375L19.6875 29.625L22.9375 28.2813L21.9531 24.0469Q22.5469 23.5625 23.0469 23.0547Q23.5469 22.5469 24.0469 21.9531L28.2813 22.9375L29.625 19.6875L25.9375 17.375ZM15.9063 10.0313Q17.125 10.0313 18.1953 10.4922Q19.2656 10.9531 20.0625 11.75Q20.8594 12.5469 21.3203 13.6172Q21.7813 14.6875 21.7813 15.9063Q21.7813 17.125 21.3203 18.1953Q20.8594 19.2656 20.0625 20.0625Q19.2656 20.8594 18.1953 21.3203Q17.125 21.7813 15.9063 21.7813Q14.6875 21.7813 13.6172 21.3203Q12.5469 20.8594 11.75 20.0625Q10.9531 19.2656 10.4922 18.1953Q10.0313 17.125 10.0313 15.9063Q10.0313 14.6875 10.4922 13.6172Q10.9531 12.5469 11.75 11.75Q12.5469 10.9531 13.6172 10.4922Q14.6875 10.0313 15.9063 10.0313ZM15.9063 20.0313Q16.7656 20.0313 17.5156 19.7109Q18.2656 19.3906 18.8281 18.8281Q19.3906 18.2656 19.7109 17.5156Q20.0313 16.7656 20.0313 15.9063Q20.0313 15.0469 19.7109 14.2969Q19.3906 13.5469 18.8281 12.9844Q18.2656 12.4219 17.5156 12.1016Q16.7656 11.7813 15.9063 11.7813Q15.0469 11.7813 14.2969 12.1016Q13.5469 12.4219 12.9844 12.9844Q12.4219 13.5469 12.1016 14.2969Q11.7813 15.0469 11.7813 15.9063Q11.7813 16.7656 12.1016 17.5156Q12.4219 18.2656 12.9844 18.8281Q13.5469 19.3906 14.2969 19.7109Q15.0469 20.0313 15.9063 20.0313Z</StreamGeometry>
    <StreamGeometry x:Key="GistIcon">M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z</StreamGeometry>
  </UserControl.Resources>
  <Design.DataContext>
    <vm:MainViewModel />
  </Design.DataContext>

  <UserControl.Styles>

    <Style Selector="MenuItem.main">
      <Setter Property="TextBlock.Foreground" Value="{DynamicResource SystemAltHighColor}" />
      <Style Selector="^:selected">
        <Style Selector="^ /template/ ContentPresenter#PART_HeaderPresenter">
          <Setter Property="Foreground" Value="{DynamicResource SystemAltHighColor}" />
        </Style>
      </Style>
      <Style Selector="^:pressed /template/ Border#PART_LayoutRoot:pointerover">
        <Setter Property="Background" Value="{DynamicResource MenuFlyoutItemBackgroundPressed}" />
        <Style Selector="^ ContentPresenter#PART_HeaderPresenter">
          <Setter Property="Foreground" Value="{DynamicResource SystemAltHighColor}" />
        </Style>
      </Style>
    </Style>


    <Style Selector="Button.main">
      <Setter Property="Margin" Value="0" />
      <Setter Property="Background" Value="#7F8b44ac" />
      <Setter Property="(TextElement.Foreground)" Value="{DynamicResource SystemAltHighColor}" />
    </Style>
    <Style Selector="Button.main:pointerover">
      <Setter Property="(TextElement.Foreground)" Value="{DynamicResource SystemAltHighColor}" />
    </Style>
    <Style Selector="Button.main:pointerover PathIcon">
      <Setter Property="(TextElement.Foreground)" Value="{DynamicResource SystemAltHighColor}" />
    </Style>

  </UserControl.Styles>

  <Grid ColumnDefinitions="Auto,*,Auto,Auto" RowDefinitions="*,Auto">

    <DockPanel Grid.Row="0" Grid.Column="0">

      <console:OnPlatform>
        <console:OnPlatform.Default>
          <Image Source="/Assets/Logo.png"
                 Margin="6,6,6,6"
                 Height="32"
                 DockPanel.Dock="Left"/>
        </console:OnPlatform.Default>
        <console:OnPlatform.Console>
          <TextBlock Text="@"/>
        </console:OnPlatform.Console>
      </console:OnPlatform>

      <Label FontSize="18"
             Foreground="White"
             FontWeight="SemiBold"
             Margin="6,6,0,6"
             VerticalAlignment="Center"
             Classes="text"
             Content="Avalonia Play" />

      <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Spacing="6" Margin="6,0,6,0">

        <Menu VerticalAlignment="Center">

          <MenuItem Header="File" Classes="main">
            <MenuItem Header="Open Xaml..." Command="{Binding OpenXamlFileCommand}" />
            <MenuItem Header="Save Xaml As..." Command="{Binding SaveXamlFileCommand}" />
            <Separator />
            <MenuItem Header="Open Code..." Command="{Binding OpenCodeFileCommand}" />
            <MenuItem Header="Save Code As..." Command="{Binding SaveCodeFileCommand}" />
          </MenuItem>

          <MenuItem Header="Run"
                    Classes="main"
                    Command="{Binding RunCommand}" />

          <MenuItem CornerRadius="3"
                    Classes="main popup"
                    ItemsSource="{Binding Samples}">
            <MenuItem.Header>
              <StackPanel Orientation="Horizontal"
                          Margin="0,4,0,3">
                <Label Content="Samples"
                       Classes="text" />
                <Path Data="M 0 0 L 7 7 L 14 0"
                      HorizontalAlignment="Center"
                      VerticalAlignment="Center"
                      Stretch="None"
                      Stroke="{DynamicResource SystemAltHighColor}"
                      StrokeThickness="1"
                      Margin="6,0,0,0"/>
              </StackPanel>
            </MenuItem.Header>
            <MenuItem.Styles>
              <Style Selector="MenuItem > MenuItem" x:DataType="vm:SampleViewModel">
                <Setter Property="Padding" Value="6"/>
                <Setter Property="Header" Value="{Binding Name}"/>
                <Setter Property="Command" Value="{Binding OpenCommand}"/>
              </Style>
              <Style Selector="MenuItem.popup /template/ Popup#PART_Popup" x:DataType="vm:SampleViewModel">
                <Setter Property="MaxHeight" Value="430"/>
              </Style>
            </MenuItem.Styles>
          </MenuItem>

        </Menu>

      </StackPanel>

    </DockPanel>

    <Button Grid.Row="0"
            Grid.Column="2"
            Classes="main"
            ToolTip.Tip="Gist">
      <Button.Flyout>
        <Flyout Placement="Bottom">
          <DockPanel Width="400">
            <Label Content="The GitHub gist must contain file named Main.axaml"
                   Margin="0,0,0,10"
                   Classes="text"
                   DockPanel.Dock="Top" />
            <Button DockPanel.Dock="Bottom"
                    Margin="0,10,0,0"
                    HorizontalAlignment="Right"
                    Content="Get"
                    Command="{Binding GistCommand}"
                    CommandParameter="{Binding #Id.Text}" />
            <Label Content="Id:"
                   VerticalAlignment="Center"
                   Classes="text"/>
            <TextBox Name="Id"
                     Text="" />
          </DockPanel>
        </Flyout>
      </Button.Flyout>

      <console:OnPlatform>
        <console:OnPlatform.Default>
          <PathIcon Width="16" Height="16"
                  Margin="0,0,0,0"
                  Data="{DynamicResource GistIcon}"/>
        </console:OnPlatform.Default>
        <console:OnPlatform.Console>
          <TextBlock Text="🐙"/>
        </console:OnPlatform.Console>
      </console:OnPlatform>
    </Button>

    <Button Grid.Row="0"
            Grid.Column="3"
            Classes="main"
            ToolTip.Tip="Settings">
      <Button.Flyout>
        <Flyout ShowMode="TransientWithDismissOnPointerMoveAway"
                Placement="BottomEdgeAlignedRight">
          <StackPanel Spacing="12">
            <CheckBox Margin="0,0,0,0"
                      Content="Live Preview"
                      IsChecked="{Binding EnableAutoRun}" />
            <Label Content="Font size:" />
            <NumericUpDown Value="{Binding EditorFontSize, Mode=TwoWay}"
                           Increment="1"
                           Minimum="1"
                           Watermark="Font size"
                           MinWidth="120"/>
          </StackPanel>
        </Flyout>
      </Button.Flyout>
      <console:OnPlatform>
        <console:OnPlatform.Default>
          <PathIcon Width="16" Height="16"
                Margin="0,0,6,0"
                Data="{DynamicResource SettingsIcon}"/>
        </console:OnPlatform.Default>
        <console:OnPlatform.Console>
          <TextBlock Text="{StaticResource Icon_Settings}"/>
        </console:OnPlatform.Console>
      </console:OnPlatform>
    </Button>

    <Separator Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="4"
               Margin="0,0,0,0"
               Background="{DynamicResource SystemChromeAltLowColor}"
               Height="0.55"/>
  </Grid>
</UserControl>

